<div class="row">
  <div class="col-lg-4 mb-4">
    <div class="box-body admin-box bg-white p-4 h-100 rounded-10 table-bordered border-radius-5">
      <div class="chart-header">
        <h3 class="chart-main-title mb-0">Seating Capacity </h3>
        <p class="chart-sub-title text-blue3 mb-3"></p>
        <div>
  				<%= area_chart(@simulations.group_by_day(:created_at).sum(:annual_seating_capacity), id: 'seating_capacity') %>
  			</div>
  		</div>
  	</div>
  </div>
  <div class="col-lg-4 mb-4">
    <div class="box-body admin-box bg-white p-4 h-100 rounded-10 table-bordered border-radius-5">
      <div class="chart-header">
        <h3 class="chart-main-title mb-0">Visitor Attendance</h3>
        <p class="chart-sub-title text-blue3 mb-3"></p>
        <div>
  				<%= line_chart(@visitor_attendance, id: 'vistior_chart') %>
  			</div>
  		</div>
  	</div>
  </div>
  <div class="col-lg-4 mb-4">
    <div class="box-body admin-box bg-white p-4 h-100 rounded-10 table-bordered border-radius-5">
      <div class="chart-header">
        <h3 class="chart-main-title mb-0">WIFILP</h3>
        <p class="chart-sub-title text-blue3 mb-3"></p>
        <div>
  				<%= column_chart(@wifi_login, id: 'wifi_lp') %>
  			</div>
  		</div>
  	</div>
  </div>
</div>
<div class="row">
  <div class="col-lg-3 mb-4">
    <div class="box-body admin-box bg-white p-4 h-100 rounded-10 table-bordered border-radius-5">
      <div class="chart-header">
        <h3 class="chart-main-title mb-0">CPM LP Revenue</h3>
        <p class="chart-sub-title text-blue3 mb-3"></p>
        <div>
  				<%= column_chart(@lp_impression, id: 'cpm_lp') %>
  			</div>
  		</div>
  	</div>
  </div>
  <div class="col-lg-3 mb-4">
    <div class="box-body admin-box bg-white p-4 h-100 rounded-10 table-bordered border-radius-5">
      <div class="chart-header">
        <h3 class="chart-main-title mb-0">User Impression</h3>
        <p class="chart-sub-title text-blue3 mb-3"></p>
        <div>
  				<%= column_chart(@user_impression, id: 'user_impression') %>
  			</div>
  		</div>
  	</div>
  </div>
  <div class="col-lg-3 mb-4">
    <div class="box-body admin-box bg-white p-4 h-100 rounded-10 table-bordered">
      <div class="chart-header">
        <h3 class="chart-main-title mb-0">CPM Impression Revenue</h3>
        <p class="chart-sub-title text-blue3 mb-3"></p>
        <div>
  				<%= column_chart(@cpm_lpm, id: 'cpm_impression') %>
  			</div>
  		</div>
  	</div>
  </div>
  <div class="col-lg-3 mb-4">
    <div class="box-body admin-box bg-white p-4 h-100 rounded-10 table-bordered border-radius-5">
      <div class="chart-header">
        <h3 class="chart-main-title mb-0">WIFI Revenue</h3>
        <p class="chart-sub-title text-blue3 mb-3"></p>
        <div>
          <%= area_chart(@simulations.group_by_day(:created_at).sum(:wifi_annual_total), id: 'wifi_revenue') 
          %>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(document).ready(function (){
    var chart = Chartkick.charts["vistior_chart"]
    var seating_capacity = Chartkick.charts["seating_capacity"]
    var wifi_revenue = Chartkick.charts["wifi_revenue"]
    var wifi_lp = Chartkick.charts["wifi_lp"]
    var cpm_lp = Chartkick.charts["cpm_lp"]
    var user_impression = Chartkick.charts["user_impression"]
    var cpm_impression = Chartkick.charts["cpm_impression"]

    var newOptions = {
      library: {
        thousands: ",",
        tooltips: {
          callbacks: {
            title: function(value){
              d = new Date(value[0].label);
              str = d.getDate() + '/' + d.getMonth() + '/' + d.getFullYear();
              return str;
            },
            label: function(tooltipItem) {
              return (parseFloat(tooltipItem.value)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,')
            }
          }
        },
        plugins: {
          datalabels: {
            align: 'end',
            anchor: 'end',
            backgroundColor: function(context) {
              return context.dataset.backgroundColor;
            },
            borderRadius: 4,
            color: 'white',
            font: {
              weight: 'bold'
            },
            formatter: function(value) {
              return (value).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');   
            },
            padding: 5
          }
        },

        scales: {
          xAxes: [{
              ticks: {
                callback: function(value) {
                  d = new Date(value);
                  var str = ('0' + d.getDate()).slice(-2) + '/' + ('0' + (d.getMonth()+1)).slice(-2)
                  return str;
                }
              }
          }],
        }
      }
    }

    var newOptions2 = {
      library: {
        thousands: ",",
        tooltips: {
          callbacks: {
            title: function(value){
              d = new Date(value[0].label);
              str = d.getDate() + '/' + d.getMonth() + '/' + d.getFullYear();
              return str;
            },
            label: function(tooltipItem) {
              return (parseFloat(tooltipItem.value)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,')
            }
          }
        },
        plugins: {
          datalabels: {
            backgroundColor: function(context) {
              return context.dataset.backgroundColor;
            },
            borderRadius: 4,
            color: 'white',
            font: {
              weight: 'bold'
            },
            formatter: function(value) {
              return (value).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');   
            },
            padding: 5
          }
        },
        scales: {
          xAxes: [{
              ticks: {
                callback: function(value) {
                  d = new Date(value);
                  var str = d.getDay() + '/' + d.getMonth() ;
                  var str = ('0' + d.getDate()).slice(-2) + '/' + ('0' + (d.getMonth()+1)).slice(-2)
                  return str;
                }
              }
          }],
        }

      }
    }

    var mergedOptions = jQuery.extend(chart.options,newOptions2)
    chart.setOptions(mergedOptions);
    var SeatingOptions = jQuery.extend(seating_capacity.options,newOptions2)
    seating_capacity.setOptions(SeatingOptions);
    var WifiOptions = jQuery.extend(wifi_revenue.options,newOptions2)
    wifi_revenue.setOptions(WifiOptions);
    var WifiLP = jQuery.extend(wifi_lp.options,newOptions)
    wifi_lp.setOptions(WifiLP);
    var CPMLP = jQuery.extend(cpm_lp.options,newOptions)
    cpm_lp.setOptions(CPMLP);
    var UserImpressionOption = jQuery.extend(user_impression.options,newOptions)
    user_impression.setOptions(UserImpressionOption);
    var CPMImpressionOption = jQuery.extend(cpm_impression.options,newOptions)
    cpm_impression.setOptions(CPMImpressionOption);

  })
</script>